<app-navigation />

<div class="main d-flex flex-column flex-md-row">
  <div id="carouselContainer" class="carousel col-12 col-md-6 d-flex justify-content-center align-items-center border">
    <div class="carousel-inner">
      @for (media of post?.media; track $index)
      {
      <div class="carousel-item" [ngClass]="{'active': activeCarouselMedia === $index}">
        <img [src]="media.url" alt="Post media" />
      </div>
      }
    </div>

    @if (post?.media && post?.media?.length! > 1)
    {
    @if (activeCarouselMedia !== 0)
    {
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselContainer" data-bs-slide="prev" (click)="previousMedia()">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    }
    @if (activeCarouselMedia !== post?.media?.length! - 1)
    {
    <button class="carousel-control-next" type="button" data-bs-target="#carouselContainer" data-bs-slide="next" (click)="nextMedia()">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
    }

    <div class="media-counter small">
      {{ activeCarouselMedia + 1 }}/{{ post?.media?.length! }}
    </div>
    }
  </div>

  <div class="col-12 col-md-6 d-flex flex-column p-2 h-100">
    <div class="overflow-auto flex-grow-1">
      <div [innerHtml]="formatString(post?.description)" class="border-bottom pb-2"></div>
      <div class="py-2 border-bottom">
        <span>
          <app-heart-icon [status]="post?.isLiked" (click)="likePost()" />
          @if (post?.isLiked && post?.likesCount === 2) { You and 1 other }
          @else if (post?.isLiked && post?.likesCount! > 2) { You and {{ post?.likesCount! - 1 }} others}
          @else if (post?.isLiked) { You }
          @else if (post?.likesCount === 1) { 1 Person }
          @else if (post?.likesCount! > 1) { {{ post?.likesCount }} People }
          @else { {{ post?.likesCount || 0 }} }
          liked this post
        </span>
      </div>

      <div class="flex-grow-1 py-2" style="min-height: 50%;">
        @for (comment of comments; track $index)
        {
        <div>id:{{comment?.id}}, message:{{comment?.message}}</div>
        }
        @if (comments.length === 0)
        {
        <div class="text-center">No comments available.</div>
        }
      </div>
    </div>

    @if (post?.allowComments)
    {
    <!--<input class="form-control" type="text" />-->
    <app-message-box (submit)="createComment($event)" />
    }
  </div>
</div>
